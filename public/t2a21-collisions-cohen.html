<!DOCTYPE html>
<html>
<head>
  <style>
    .square {
      position: absolute;
      width: 100px;
      height: 100px;
      border: 2px solid black;
    }

    #player {
      background: red;
      left: 50px;
      top: 50px;
    }

    #enemy {
      background: green;
      left: 300px;
      top: 50px;
    }
  </style>
</head>

<!-- tabindex makes body focusable -->
<body tabindex="0">

<h1 style="text-align:center;">Collision Demo</h1>

<div id="player" class="square"></div>
<div id="enemy" class="square"></div>

<script>
  const player = document.getElementById("player");
  const enemy = document.getElementById("enemy");

  // Give focus so keydown events work
  document.body.focus();

  // Reliable collision detection
  function collides(a, b) {
    const r1 = a.getBoundingClientRect();
    const r2 = b.getBoundingClientRect();

    return !(
      r1.right < r2.left ||
      r1.left > r2.right ||
      r1.bottom < r2.top ||
      r1.top > r2.bottom
    );
  }

  document.addEventListener("keydown", (e) => {
    const step = 10;

    let left = parseInt(player.style.left);
    let top = parseInt(player.style.top);

    if (e.key === "ArrowLeft")  player.style.left = (left - step) + "px";
    if (e.key === "ArrowRight") player.style.left = (left + step) + "px";
    if (e.key === "ArrowUp")    player.style.top  = (top - step) + "px";
    if (e.key === "ArrowDown")  player.style.top  = (top + step) + "px";

    if (collides(player, enemy)) {
      alert("Collision!");
      player.style.left = "50px";
      player.style.top = "50px";
    }
  });
</script>

</body>
</html>
