<!DOCTYPE html>
<html lang="en">
<head>
  <title>t1a16-move-div-cohen.html</title>
  <meta charset="UTF-8">
  <style>
    body {
      background: #eef;
      font-family: Arial, sans-serif;
      overflow: hidden;
      margin: 0;
      padding: 0;
    }
    h1 { text-align: center; }
    .obj {
      position: absolute;
      width: 50px;
      height: 50px;
      border-radius: 10px;
      text-align: center;
      line-height: 50px;
      color: white;
      font-weight: bold;
    }
    /* Starting positions */
    #obj1 { background: red;   left: 50px;  top: 200px; }
    #obj2 { background: blue;  left: 200px; top: 300px; }
    #obj3 { background: green; left: 350px; top: 400px; }
    #obj4 { background: orange;left: 500px; top: 500px; }
    #obj5 { background: purple;left: 250px; top: 150px; }
    #obj6 { background: brown; left: 400px; top: 200px; }
    #obj7 { background: teal;  left: 600px; top: 250px; }
    #obj8 { background: black; left: 700px; top: 350px; }
  </style>
</head>
<body>
  <h1>t1a16-move-div-cohen.html</h1>
  <p style="text-align:center;">Use arrow keys to move the red box — watch them bounce off each other!</p>

  <!-- 8 objects -->
  <div id="obj1" class="obj">1</div>
  <div id="obj2" class="obj">2</div>
  <div id="obj3" class="obj">3</div>
  <div id="obj4" class="obj">4</div>
  <div id="obj5" class="obj">5</div>
  <div id="obj6" class="obj">6</div>
  <div id="obj7" class="obj">7</div>
  <div id="obj8" class="obj">8</div>

  <div style="text-align:center; margin-top:620px;">
    <button onclick="startAll()">▶ Start All</button>
    <button onclick="stopAll()">⏸ Stop All</button>
  </div>

  <script>
    let myTimers = [];
    let angles = Array(8).fill(0);
    let allObjs = [];
    let speeds = {
      obj2: { dx: 3, dy: 2 },
      obj3: { dx: -3, dy: 3 },
      obj4: { dx: 4, dy: -2 },
    };

    function getNum(val) { return parseInt(val || 0); }

    function getRect(el) {
      return {
        x: getNum(el.style.left),
        y: getNum(el.style.top),
        w: el.offsetWidth,
        h: el.offsetHeight
      };
    }

    function isColliding(a, b) {
      return (
        a.x < b.x + b.w &&
        a.x + a.w > b.x &&
        a.y < b.y + b.h &&
        a.y + a.h > b.y
      );
    }

    function moveBounce(id) {
      const el = document.getElementById(id);
      let x = getNum(el.style.left);
      let y = getNum(el.style.top);
      let { dx, dy } = speeds[id];

      x += dx;
      y += dy;

      // Wall bounce
      if (x < 0 || x > window.innerWidth - 60) dx *= -1;
      if (y < 0 || y > window.innerHeight - 60) dy *= -1;

      el.style.left = x + 'px';
      el.style.top = y + 'px';
      speeds[id] = { dx, dy };
    }

    // Collision check between all moving ones
    function checkCollisions() {
      const ids = ['obj1', 'obj2', 'obj3', 'obj4'];
      for (let i = 0; i < ids.length; i++) {
        for (let j = i + 1; j < ids.length; j++) {
          const el1 = document.getElementById(ids[i]);
          const el2 = document.getElementById(ids[j]);
          if (isColliding(getRect(el1), getRect(el2))) {
            // Reverse both directions
            if (speeds[ids[i]]) speeds[ids[i]].dx *= -1, speeds[ids[i]].dy *= -1;
            if (speeds[ids[j]]) speeds[ids[j]].dx *= -1, speeds[ids[j]].dy *= -1;
          }
        }
      }
    }

    function moveCircle(id, cx, cy, radius, speed, index) {
      const el = document.getElementById(id);
      angles[index] += speed;
      el.style.left = cx + radius * Math.cos(angles[index]) + 'px';
      el.style.top  = cy + radius * Math.sin(angles[index]) + 'px';
    }

    function startAll() {
      stopAll();
      allObjs = Array.from(document.getElementsByClassName('obj'));

      // Moving objects
      myTimers.push(setInterval(() => moveBounce('obj2'), 30));
      myTimers.push(setInterval(() => moveBounce('obj3'), 30));
      myTimers.push(setInterval(() => moveBounce('obj4'), 30));

      // Collisions
      myTimers.push(setInterval(checkCollisions, 30));

      // Decorative ones
      myTimers.push(setInterval(() => moveCircle('obj5', 400, 300, 150, 0.1, 4), 50));
      let r6 = 20;
      myTimers.push(setInterval(() => {
        moveCircle('obj6', 600, 400, r6, 0.15, 5);
        r6 += 0.3;
        if (r6 > 200) r6 = 20;
      }, 50));

      myTimers.push(setInterval(() => {
        const el = document.getElementById('obj7');
        el.style.left = Math.random() * (window.innerWidth - 60) + 'px';
        el.style.top  = Math.random() * (window.innerHeight - 60) + 'px';
      }, 300));

      let x8 = 0;
      myTimers.push(setInterval(() => {
        const el = document.getElementById('obj8');
        x8 += 5;
        el.style.left = (x8 % (window.innerWidth - 60)) + 'px';
        el.style.top  = 400 + 100 * Math.sin(x8 / 50) + 'px';
      }, 50));
    }

    function stopAll() {
      myTimers.forEach(clearInterval);
      myTimers = [];
    }

    // Manual movement for red player (obj1)
    let playerSpeed = 10;
    window.addEventListener('keydown', (e) => {
      const el = document.getElementById('obj1');
      let x = getNum(el.style.left);
      let y = getNum(el.style.top);

      if (e.key === 'ArrowRight') x += playerSpeed;
      if (e.key === 'ArrowLeft')  x -= playerSpeed;
      if (e.key === 'ArrowUp')    y -= playerSpeed;
      if (e.key === 'ArrowDown')  y += playerSpeed;

      el.style.left = Math.max(0, Math.min(x, window.innerWidth - 60)) + 'px';
      el.style.top  = Math.max(0, Math.min(y, window.innerHeight - 60)) + 'px';
    });
  </script>
</body>
</html>
